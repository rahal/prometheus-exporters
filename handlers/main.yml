---
# handlers file for rahal.prometheus-exporters

- name: reload nginx
  service: name=nginx state=reloaded
  when: (nginx_is_service == True)


# start exporter mysql
- name: start mysql exporter
  docker_service:
    project_src: "{{ root_monitoring_mysql }}"
    project_name: "prom_exporter_{{ item.name }}"
  environment:
      PORT: "{{ item.prom_port }}"
      MYSQL_CONTAINER: "{{ item.name }}"
      DATA_SOURCE_NAME: "{{ item.user }}:{{ item.pass }}@tcp(bdd:{{ item.port }})/"
      NETWORK_MODE: "{{ item.network }}"
  with_items: "{{ mysql_containers }}"

